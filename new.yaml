- measure: trade_margin_per_kg
  label: "Trade Margin Per KG"
  type: number
  sql: (${sales_value} / ${sales_volume}) - (${net_sales_other} / ${internal_sales_volume} * 1000) ;;

- measure: trade_margin
  label: "Trade Margin"
  type: number
  sql: ${sales_value} - ${net_sales_other} ;;
  
  measure: rsv
  type: number
  sql: ${sales_value} / (SELECT sum(sales_value) FROM ${TABLE})
  
  
  dimension_group: trade_margin_classification {
  type: tier
  based_on: ${TABLE}.trade_margin_per_kg
  tiers: [
    {value: 1.46, label: "C", html_style: "color: red;"},
    {value: 2.09, label: "B", html_style: "color: orange;"},
    {value: "Infinity", label: "A", html_style: "color: green;"},
  ]
}

dimension_group: trade_margin_classification {
  type: tier
  based_on: ${TABLE}.trade_margin_per_kg
  tiers: [
    {value: 1.46, label: "C", html_style: "color: red;"},
    {value: 2.09, label: "B", html_style: "color: orange;"},
    {value: "Infinity", label: "A", html_style: "color: green;"},
  ]
}

